(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3698],{3371:(e,s,r)=>{"use strict";r.d(s,{A:()=>d});var l=r(5155),a=r(2115),t=r(63),i=r(5419);function d(e){let{children:s,requiredRole:r}=e,{user:d,isLoaded:n}=(0,i.Jd)(),o=(0,t.useRouter)(),[c,h]=(0,a.useState)(!0),[x,u]=(0,a.useState)(!1);return((0,a.useEffect)(()=>{!async function(){if(n){if(!(null==d?void 0:d.id))return o.push("/");try{try{let e=await fetch("/api/users/ensure-role");if(!e.ok){let s=await e.text();console.error("Failed to ensure role:",s)}}catch(e){console.error("Error calling ensure-role:",e)}let e=await fetch("/api/users/me");if(!e.ok){console.error("Failed to fetch user data"),o.push("/");return}let s=(await e.json()).role;if(console.log("RoleGate: User role is",s,"Required:",r),!s){console.log("RoleGate: No role found, redirecting home"),o.push("/");return}if(r&&!r.includes(s)){console.log("RoleGate: User doesn't have required role, redirecting to their dashboard"),"RIDER"===s?o.push("/rider"):"DRIVER"===s?o.push("/driver"):"DISPATCHER"===s?o.push("/dispatcher"):"ADMIN"===s?o.push("/admin"):o.push("/");return}console.log("RoleGate: Access granted"),u(!0)}catch(e){console.error("Error checking role:",e)}finally{h(!1)}}}()},[d,n,o,r]),c)?(0,l.jsx)("div",{className:"max-w-4xl mx-auto p-6",children:(0,l.jsx)("div",{className:"text-center",children:"Loading..."})}):x?(0,l.jsx)(l.Fragment,{children:s}):null}},4130:(e,s,r)=>{Promise.resolve().then(r.bind(r,5782))},5782:(e,s,r)=>{"use strict";r.r(s),r.d(s,{default:()=>i});var l=r(5155),a=r(3371);function t(){return(0,l.jsxs)("div",{className:"max-w-6xl mx-auto p-6 space-y-6",children:[(0,l.jsxs)("div",{className:"mb-6",children:[(0,l.jsx)("h1",{className:"text-3xl font-bold mb-2",children:"Admin Dashboard"}),(0,l.jsx)("p",{className:"text-gray-600",children:"Manage users, drivers, and settings"})]}),(0,l.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[(0,l.jsxs)("div",{className:"border rounded-lg p-6",children:[(0,l.jsx)("h3",{className:"font-semibold mb-2",children:"Users"}),(0,l.jsx)("p",{className:"text-3xl font-bold",children:"0"}),(0,l.jsx)("p",{className:"text-sm text-gray-600",children:"Total users"})]}),(0,l.jsxs)("div",{className:"border rounded-lg p-6",children:[(0,l.jsx)("h3",{className:"font-semibold mb-2",children:"Drivers"}),(0,l.jsx)("p",{className:"text-3xl font-bold",children:"0"}),(0,l.jsx)("p",{className:"text-sm text-gray-600",children:"Active drivers"})]}),(0,l.jsxs)("div",{className:"border rounded-lg p-6",children:[(0,l.jsx)("h3",{className:"font-semibold mb-2",children:"Bookings"}),(0,l.jsx)("p",{className:"text-3xl font-bold",children:"0"}),(0,l.jsx)("p",{className:"text-sm text-gray-600",children:"Today's rides"})]})]}),(0,l.jsxs)("div",{className:"border rounded-lg p-6",children:[(0,l.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"Quick Actions"}),(0,l.jsxs)("div",{className:"flex gap-3 flex-wrap",children:[(0,l.jsx)("a",{href:"/admin/metrics",className:"px-4 py-2 btn-primary rounded",children:"View Metrics"}),(0,l.jsx)("a",{href:"/admin/ops",className:"px-4 py-2 btn-secondary rounded",children:"Operations"}),(0,l.jsx)("a",{href:"/admin/settings",className:"px-4 py-2 border rounded hover:bg-gray-50",children:"Settings"})]})]})]})}function i(){return(0,l.jsx)(a.A,{requiredRole:["ADMIN"],children:(0,l.jsx)(t,{})})}}},e=>{e.O(0,[1162,8441,1255,7358],()=>e(e.s=4130)),_N_E=e.O()}]);