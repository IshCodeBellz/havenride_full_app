exports.id=4793,exports.ids=[4793],exports.modules={3676:(a,b,c)=>{"use strict";c.d(b,{A:()=>f});var d=c(21124),e=c(38301);function f({bookingId:a,sender:b}){let[c,f]=(0,e.useState)([]),[g,h]=(0,e.useState)(""),[i,j]=(0,e.useState)(!0),[k,l]=(0,e.useState)(!1),m=(0,e.useRef)(null);(0,e.useRef)(null);let n=(0,e.useCallback)(async()=>{if(!g.trim())return;let c=g.trim();h("");let d={id:`temp-${Date.now()}`,bookingId:a,sender:b,text:c,createdAt:new Date().toISOString()};f(a=>[...a,d]);try{let e=await fetch(`/api/bookings/${a}/messages`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({sender:b,text:c})});if(e.ok){let a=await e.json();f(b=>b.map(b=>b.id===d.id?a:b))}else f(a=>a.filter(a=>a.id!==d.id)),h(c),console.error("Failed to send message")}catch(a){f(a=>a.filter(a=>a.id!==d.id)),h(c),console.error("Error sending message:",a)}},[g,a,b]),o=(0,e.useCallback)(a=>{"Enter"!==a.key||a.shiftKey||(a.preventDefault(),n())},[n]);return(0,d.jsxs)("div",{className:"border rounded-lg flex flex-col h-80",children:[(0,d.jsxs)("div",{className:"p-2 border-b font-semibold bg-gray-50 flex items-center justify-between",children:[(0,d.jsx)("span",{children:"Chat"}),!k&&(0,d.jsx)("span",{className:"text-xs text-gray-500",children:"(polling mode)"})]}),(0,d.jsxs)("div",{className:"flex-1 overflow-auto p-2 space-y-1 text-sm",children:[i?(0,d.jsx)("div",{className:"text-center text-gray-500 py-4",children:"Loading messages..."}):0===c.length?(0,d.jsx)("div",{className:"text-center text-gray-500 py-4",children:"No messages yet. Start the conversation!"}):c.map(a=>(0,d.jsxs)("div",{className:"RIDER"===a.sender?"text-blue-700":"DRIVER"===a.sender?"text-green-700":"text-gray-800",children:[(0,d.jsxs)("span",{className:"font-semibold mr-1",children:[a.sender,":"]}),a.text]},a.id)),(0,d.jsx)("div",{ref:m})]}),(0,d.jsxs)("div",{className:"p-2 flex gap-2 border-t bg-gray-50",children:[(0,d.jsx)("input",{value:g,onChange:a=>h(a.target.value),onKeyPress:o,className:"border rounded px-2 py-1 flex-1 focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Type a messageâ€¦",autoComplete:"off"}),(0,d.jsx)("button",{onClick:n,disabled:!g.trim(),className:"px-3 py-1 bg-blue-600 text-white rounded hover:bg-blue-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:"Send"})]})]})}c(72929)},10389:(a,b,c)=>{"use strict";c.d(b,{A:()=>m});var d=c(21124),e=c(3991),f=c.n(e),g=c(24515),h=c(42378),i=c(57958);function j({userRole:a}){let b=(0,h.usePathname)(),c="DRIVER"===a?"/driver":"DISPATCHER"===a?"/dispatcher":"ADMIN"===a?"/admin":"/rider";return(0,d.jsxs)("div",{className:"w-64 min-h-screen bg-[#0F3D3E] text-white flex flex-col",children:[(0,d.jsx)("div",{className:"p-6 flex justify-center",children:(0,d.jsx)("div",{className:"w-32 h-32 bg-white rounded-full flex items-center justify-center",children:(0,d.jsx)(g.default,{src:"/images/HavenRideIcon.png",alt:"HavenRide Logo",width:120,height:120,className:"object-contain"})})}),(0,d.jsxs)("nav",{className:"flex-1 px-4 space-y-2",children:[(0,d.jsxs)(f(),{href:c,className:`flex items-center gap-3 px-4 py-3 rounded-lg transition-colors ${b===c?"bg-[#1a5557]":"hover:bg-[#1a5557] hover:bg-opacity-50"}`,children:[(0,d.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,d.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"})}),(0,d.jsx)("span",{children:"Home"})]}),(0,d.jsxs)(f(),{href:`${c}/past-rides`,className:`flex items-center gap-3 px-4 py-3 rounded-lg transition-colors ${b===`${c}/past-rides`?"bg-[#1a5557]":"hover:bg-[#1a5557] hover:bg-opacity-50"}`,children:[(0,d.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,d.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})}),(0,d.jsx)("span",{children:"Past Rides"})]}),(0,d.jsxs)(f(),{href:`${c}/support`,className:`flex items-center gap-3 px-4 py-3 rounded-lg transition-colors ${b===`${c}/support`?"bg-[#1a5557]":"hover:bg-[#1a5557] hover:bg-opacity-50"}`,children:[(0,d.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,d.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8.228 9c.549-1.165 2.03-2 3.772-2 2.21 0 4 1.343 4 3 0 1.4-1.278 2.575-3.006 2.907-.542.104-.994.54-.994 1.093m0 3h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),(0,d.jsx)("span",{children:"Support"})]}),(0,d.jsxs)(f(),{href:`${c}/profile`,className:`flex items-center gap-3 px-4 py-3 rounded-lg transition-colors ${b===`${c}/profile`?"bg-[#1a5557]":"hover:bg-[#1a5557] hover:bg-opacity-50"}`,children:[(0,d.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,d.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})}),(0,d.jsx)("span",{children:"Profile"})]}),"DRIVER"===a&&(0,d.jsxs)(f(),{href:"/driver/earnings",className:`flex items-center gap-3 px-4 py-3 rounded-lg transition-colors ${"/driver/earnings"===b?"bg-[#1a5557]":"hover:bg-[#1a5557] hover:bg-opacity-50"}`,children:[(0,d.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,d.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),(0,d.jsx)("span",{children:"Earnings"})]})]}),(0,d.jsx)("div",{className:"p-4 border-t border-[#1a5557]",children:(0,d.jsxs)("div",{className:"flex items-center gap-3",children:[(0,d.jsx)(i.uF,{afterSignOutUrl:"/"}),(0,d.jsxs)("div",{className:"flex-1",children:[(0,d.jsx)("p",{className:"text-sm font-medium",children:"Account"}),(0,d.jsx)("p",{className:"text-xs text-gray-300",children:a||"User"})]})]})})]})}var k=c(38301);function l({onTrigger:a}){let[b,c]=(0,k.useState)(!1);return(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)("button",{onClick:()=>{c(!0),a&&a()},className:"fixed bottom-6 right-6 w-16 h-16 bg-red-600 rounded-full shadow-lg hover:bg-red-700 transition-all hover:scale-110 z-50 flex items-center justify-center",title:"Emergency SOS",children:(0,d.jsx)("span",{className:"text-white font-bold text-lg",children:"SOS"})}),b&&(0,d.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-60 flex items-center justify-center p-4 z-50",children:(0,d.jsxs)("div",{className:"bg-white rounded-2xl p-8 max-w-md w-full",children:[(0,d.jsx)("div",{className:"flex justify-center mb-6",children:(0,d.jsx)("div",{className:"w-24 h-24 bg-red-600 rounded-full flex items-center justify-center",children:(0,d.jsx)("span",{className:"text-white font-bold text-3xl",children:"SOS"})})}),(0,d.jsx)("h2",{className:"text-2xl font-bold text-center text-gray-900 mb-4",children:"Emergency in Progress"}),(0,d.jsx)("p",{className:"text-center text-gray-600 mb-6",children:"Your location and driver details will be shared with HavenRide Safety Desk"}),(0,d.jsxs)("div",{className:"space-y-3",children:[(0,d.jsxs)("button",{onClick:()=>{window.location.href="tel:999"},className:"w-full bg-red-600 text-white py-4 rounded-lg font-semibold hover:bg-red-700 transition-colors flex items-center justify-center gap-2",children:[(0,d.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,d.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"})}),"Call 999"]}),(0,d.jsx)("button",{onClick:()=>{alert("Contacting HavenRide Safety Desk...")},className:"w-full border-2 border-gray-300 text-gray-700 py-4 rounded-lg font-semibold hover:bg-gray-50 transition-colors",children:"Contact HavenRide Safety Desk"}),(0,d.jsx)("button",{onClick:()=>{c(!1)},className:"w-full border-2 border-gray-300 text-gray-700 py-4 rounded-lg font-semibold hover:bg-gray-50 transition-colors",children:"Cancel Alert"})]}),(0,d.jsx)("p",{className:"text-xs text-center text-gray-500 mt-6",children:"In case of immediate danger, contact local emergency services."})]})})]})}function m({children:a,userRole:b}){return(0,d.jsxs)("div",{className:"flex min-h-screen bg-gray-50",children:[(0,d.jsx)(j,{userRole:b}),(0,d.jsx)("main",{className:"flex-1 overflow-auto",children:a}),("RIDER"===b||"DRIVER"===b)&&(0,d.jsx)(l,{})]})}},39727:()=>{},47990:()=>{},72929:(a,b,c)=>{"use strict";c.d(b,{c:()=>g});var d=c(52149);let e=null,f=!1;function g(a){let b=function(){if(f)return null;if(e)return e;let a="xxx:yyy";if(!a)return console.warn("Ably key not configured - real-time features will be disabled"),f=!0,null;try{return(e=new d.Realtime(a)).connection.on("failed",a=>{console.error("Ably connection failed:",a.reason),f=!0}),e}catch(a){return console.error("Failed to initialize Ably:",a),f=!0,null}}();return b?b.channels.get(a):{subscribe:()=>{},unsubscribe:()=>{},isMock:!0}}}};